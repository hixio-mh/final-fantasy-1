<link rel="import" href="../behaviors/ff-armor-behavior.html">
<link rel="import" href="../behaviors/ff-item-behavior.html">
<link rel="import" href="../behaviors/ff-shop-behavior.html">
<link rel="import" href="../behaviors/ff-spell-behavior.html">
<link rel="import" href="../behaviors/ff-weapon-behavior.html">

<dom-module id="ff-shop-inventory">

  <script>
  (function(scope) {
    scope.FF = scope.FF || {};

    Polymer({
      is: 'ff-shop-inventory',
      behaviors: [
        scope.FF.ArmorBehavior,
        scope.FF.ItemBehavior,
        scope.FF.ShopBehavior,
        scope.FF.SpellBehavior,
        scope.FF.WeaponBehavior
      ],
      properties: {
        items: {
          readonly: true,
          type: Array
        },
        shop: {
          readonly: true,
          type: String
        },
        shopInventory: {
          notify: true,
          type: Array
        }
      },

      observers: [
        '_buildShopInventory(items)'
      ],

      ready: function() {
        this.inventoryByShop = {};
        this.inventoryByShop[this.Shop.Armor] = this.ArmorByName,
        this.inventoryByShop[this.Shop.BlackMagic] = this.SpellsByName,
        this.inventoryByShop[this.Shop.BlackMagic2] = this.SpellsByName,
        this.inventoryByShop[this.Shop.Item] = this.ItemsByName,
        this.inventoryByShop[this.Shop.Weapon] = this.WeaponsByName,
        this.inventoryByShop[this.Shop.WhiteMagic] = this.SpellsByName
        this.inventoryByShop[this.Shop.WhiteMagic2] = this.SpellsByName
      },

      _buildShopInventory: function(items) {
        if (!this.shop) {
          return;
        }
        if (!this.inventoryByShop[this.shop]) {
          return;
        }
        this.shopInventory = items.map(function(item) {
          return Object.assign({
            name: item
          }, this.inventoryByShop[this.shop][item]);
        }, this);
      }
    });
  }(window));
  </script>
</dom-module>