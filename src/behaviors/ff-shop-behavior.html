<script>
(function(scope) {
  scope.FF = scope.FF || {};

  scope.FF.ShopBehavior = {
    properties: {
      Shop: {
        readonly: true,
        type: Object,
        value: function() {
          return {
            Armor: 'armor',
            BlackMagic: 'blackmagic',
            Clinic: 'clinic',
            Inn: 'inn',
            Item: 'item',
            Weapon: 'weapon',
            WhiteMagic: 'whitemagic'
          };
        }
      },

      Shops: {
        readonly: true,
        type: Object,
        value: {}
      }
    },

    ready: function() {
      this._inn();
      this._weapon();
    },

    _inn: function() {
      this._shop({
        id: this.Shop.Inn,
        sign: 'INN',
        states: {
          start: {
            back: 'leaving',
            conversation: ['Welcome', '  ::', 'Stay,', 'to save', 'your', 'data.'],
            choices: [
              { label: 'Yes', to: 'buying' },
              { label: 'No', to: 'leaving' }
            ]
          },
          buying: {
            back: 'leaving',
            choices: [
              { label: 'Yes', to: 'resting' },
              { label: 'No', to: 'leaving' }
            ]
          },
          resting: {
            back: 'leaving',
            conversation: ['Don\'t', 'forget,', 'if you', 'leave', 'your', 'game,'],
            fire: { event: 'ff-resting', detail: { resting: true } },
            to: 'leaving'
          },
          leaving: {
            back: 'exit',
            conversation: ['Hold', 'RESET', 'while', 'you', 'turn', 'POWER', 'off!!'],
            fire: { event: 'ff-resting', detail: { resting: false } },
            to: 'exit'
          }
        }
      });
    },

    _shop: function(data) {
      this.Shops[data.id] = data;
    },

    _weapon: function() {
      this._shop({
        id: this.Shop.Weapon,
        sign: 'WEAPON',
        states: {
          start: {
            conversation: ['Welcome'],
            choices: [
              { label: 'Buy', to: 'inventory' },
              { label: 'Sell', to: 'selling' },
              { label: 'Exit', to: 'exit' }
            ]
          },
          inventory: {
            back: 'start',
            conversation: ['What do', 'you', 'want?'],
            inventoryActive: true,
            showInventory: true,
            to: 'buying'
          },
          buying: {
            back: 'inventory',
            choices: [
              { label: 'Yes', to: 'forWhom' },
              { label: 'No', to: 'inventory' }
            ],
            showInventory: true
          },
          forWhom: {
            back: 'regretStart',
            conversation: ['Who', 'will', 'take', 'it?'],
            showInventory: true
          },
          regretStart: {
            conversation: ['Too bad', '::', 'Some-', 'thing', 'else?'],
            choices: [
              { label: 'Buy', to: 'inventory' },
              { label: 'Sell', to: 'selling' },
              { label: 'Exit', to: 'exit' }
            ],
            showInventory: true
          }
        }
      })
    }
  };

}(window));
</script>